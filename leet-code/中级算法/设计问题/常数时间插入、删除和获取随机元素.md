# [常数时间插入、删除和获取随机元素](https://leetcode-cn.com/leetbook/read/top-interview-questions-medium/xw5rt1/)

### algorithm:
- 常数时间的插入和删除提示使用HashMap
- 常数时间的插入和随机返回提示使用Array
- 结合起来，可以使用HashMap保存数字在Array中的index
- 想常数时间随机返回，Array中不能有洞，删除时要做额外处理

### corner case:
- 删除时map的操作要先set再delete，这样可以应对只剩最后一个元素的情况，不在删除之后再记录index
- 删除时array的操作要先交换再pop，这样可以应对需删除的元素处于最后一位的情况，不在删除之后重新加入

### code:
```javascript
class RandomizedSet {
    map = new Map()
    array = []

    insert(num) {
        if (this.map.has(num)) {
            return false
        }
        this.map.set(num, this.array.length)
        this.array.push(num)
        return true
    }
    remove(num) {
        if (!this.map.has(num)) {
            return false
        }
        const index = this.map.get(num)
        const lastNum = this.array[this.array.length - 1]
        this.array[index] = lastNum
        this.array.pop()
        this.map.set(lastNum, index)
        this.map.delete(num)
        return true
    }
    getRandom() {
        const index = Math.floor(Math.random() * this.array.length)
        return this.array[index]
    }
}
```
